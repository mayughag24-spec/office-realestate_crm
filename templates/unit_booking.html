

<h2>Unit Booking Form</h2>

<div class="form-section">
    <label for="wing">Wing</label>
    <select id="wing"></select>

    <label for="floor">Floor</label>
    <select id="floor"></select>

    <label for="unitType">Unit Type</label>
    <select id="unitType"></select>

    <label for="flatNo">Flat No</label>
    <select id="flatNo"></select>

    <label for="carpet">Carpet Area (sq.ft.)</label>
    <input type="number" id="carpet" readonly>

    <label for="agreementCost">Agreement Cost</label>
    <input type="number" id="agreementCost">

    <label for="gst">GST</label>
    <input type="number" id="gst" readonly>

    <label for="stampDuty">Stamp Duty</label>
    <input type="number" id="stampDuty" readonly>

    <label for="registration">Registration</label>
    <input type="number" id="registration" readonly>

    <label for="package">Package Total</label>
    <input type="number" id="package" readonly>

    <label for="furniture">Furniture</label>
    <input type="number" id="furniture">

    <button onclick="bookUnit()">Book Unit</button>
    <button onclick="clearForm()">Clear Form</button>
</div>

<h3>Booked Units</h3>
<table id="bookedUnitsTable">
    <thead>
        <tr>
            <th>Wing</th><th>Floor</th><th>Unit Type</th><th>Flat No</th><th>Carpet</th><th>Package</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>

<script>
const areaStatement = [
    // Mock data: Wing, Floor, FlatNo, UnitType, Carpet, Status
    {wing:"A", floor:"1", flatNo:"101", type:"2BHK", carpet:900, status:"AVAILABLE"},
    {wing:"A", floor:"1", flatNo:"102", type:"2BHK", carpet:920, status:"BOOKED"},
    {wing:"A", floor:"2", flatNo:"201", type:"3BHK", carpet:1100, status:"AVAILABLE"},
    {wing:"B", floor:"1", flatNo:"101", type:"2BHK", carpet:880, status:"AVAILABLE"}
];

let bookedUnits = [];

function initForm() {
    const wingSelect = document.getElementById('wing');
    const wings = [...new Set(areaStatement.map(u => u.wing))];
    wingSelect.innerHTML = '<option value="">Select Wing</option>';
    wings.forEach(w => wingSelect.innerHTML += `<option value="${w}">${w}</option>`);

    wingSelect.onchange = fillFloors;
    document.getElementById('floor').onchange = fillUnitTypes;
    document.getElementById('unitType').onchange = fillFlats;
    document.getElementById('flatNo').onchange = fillCarpet;
    document.getElementById('agreementCost').oninput = calculateAmounts;
    document.getElementById('furniture').oninput = calculateAmounts;
}

function fillFloors() {
    const wing = document.getElementById('wing').value;
    const floors = [...new Set(areaStatement.filter(u => u.wing===wing && u.status!=='BOOKED').map(u => u.floor))];
    const floorSelect = document.getElementById('floor');
    floorSelect.innerHTML = '<option value="">Select Floor</option>';
    floors.forEach(f => floorSelect.innerHTML += `<option value="${f}">${f}</option>`);
    document.getElementById('unitType').innerHTML = '<option value="">Select Unit Type</option>';
    document.getElementById('flatNo').innerHTML = '<option value="">Select Flat</option>';
    document.getElementById('carpet').value = '';
}

function fillUnitTypes() {
    const wing = document.getElementById('wing').value;
    const floor = document.getElementById('floor').value;
    const types = [...new Set(areaStatement.filter(u => u.wing===wing && u.floor===floor && u.status!=='BOOKED').map(u => u.type))];
    const typeSelect = document.getElementById('unitType');
    typeSelect.innerHTML = '<option value="">Select Unit Type</option>';
    types.forEach(t => typeSelect.innerHTML += `<option value="${t}">${t}</option>`);
    document.getElementById('flatNo').innerHTML = '<option value="">Select Flat</option>';
    document.getElementById('carpet').value = '';
}

function fillFlats() {
    const wing = document.getElementById('wing').value;
    const floor = document.getElementById('floor').value;
    const type = document.getElementById('unitType').value;
    const flats = areaStatement.filter(u => u.wing===wing && u.floor===floor && u.type===type && u.status!=='BOOKED');
    const flatSelect = document.getElementById('flatNo');
    flatSelect.innerHTML = '<option value="">Select Flat</option>';
    flats.forEach(f => flatSelect.innerHTML += `<option value="${f.flatNo}">${f.flatNo}</option>`);
    document.getElementById('carpet').value = '';
}

function fillCarpet() {
    const wing = document.getElementById('wing').value;
    const floor = document.getElementById('floor').value;
    const type = document.getElementById('unitType').value;
    const flat = document.getElementById('flatNo').value;
    const unit = areaStatement.find(u => u.wing===wing && u.floor===floor && u.type===type && u.flatNo===flat);
    if(unit) document.getElementById('carpet').value = unit.carpet;
    calculateAmounts();
}

function calculateAmounts() {
    let agreement = parseFloat(document.getElementById('agreementCost').value) || 0;
    let furniture = parseFloat(document.getElementById('furniture').value) || 0;
    let gst = agreement >= 4500000 ? agreement*0.05 : agreement*0.01;
    let stampDuty = agreement*0.07;
    let reg = agreement >= 3000000 ? 30000 : agreement*0.01;
    document.getElementById('gst').value = Math.round(gst);
    document.getElementById('stampDuty').value = Math.round(stampDuty);
    document.getElementById('registration').value = Math.round(reg);
    document.getElementById('package').value = Math.round(agreement + gst + stampDuty + reg + furniture);
}

function bookUnit() {
    const wing = document.getElementById('wing').value;
    const floor = document.getElementById('floor').value;
    const type = document.getElementById('unitType').value;
    const flat = document.getElementById('flatNo').value;
    if(!wing || !floor || !type || !flat) { alert("Select all fields"); return; }

    // Mark booked
    const unit = areaStatement.find(u => u.wing===wing && u.floor===floor && u.type===type && u.flatNo===flat);
    if(unit.status==='BOOKED') { alert("Already booked"); return; }
    unit.status='BOOKED';

    bookedUnits.push({wing,floor,type,flat,carpet:unit.carpet,package:document.getElementById('package').value});
    renderBookedUnits();
    clearForm();
}

function renderBookedUnits() {
    const tbody = document.querySelector('#bookedUnitsTable tbody');
    tbody.innerHTML = '';
    bookedUnits.forEach(u => {
        tbody.innerHTML += `<tr>
            <td>${u.wing}</td>
            <td>${u.floor}</td>
            <td>${u.type}</td>
            <td>${u.flat}</td>
            <td>${u.carpet}</td>
            <td>${u.package}</td>
        </tr>`;
    });
}

function clearForm() {
    document.getElementById('wing').value='';
    document.getElementById('floor').innerHTML='<option value="">Select Floor</option>';
    document.getElementById('unitType').innerHTML='<option value="">Select Unit Type</option>';
    document.getElementById('flatNo').innerHTML='<option value="">Select Flat</option>';
    document.getElementById('carpet').value='';
    document.getElementById('agreementCost').value='';
    document.getElementById('gst').value='';
    document.getElementById('stampDuty').value='';
    document.getElementById('registration').value='';
    document.getElementById('package').value='';
    document.getElementById('furniture').value='';
}


initForm();
</script>
