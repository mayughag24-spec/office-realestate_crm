<!DOCTYPE html>
<html>
<head>
    <title>Unit Booking</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="content">
    <h2>UNIT BOOKING</h2>

    <form id="bookingForm">

        <!-- Booking Info -->
        <fieldset>
            <div class="form-row">
                <label>Booking Date</label>
                <input type="date" required>

                <label>Sales Executive</label>
                <select required>
                    <option value="">Select</option>
                    <option>Executive 1</option>
                    <option>Executive 2</option>
                </select>
            </div>
        </fieldset>

        <!-- Applicant Section -->
        <fieldset>
            <legend>Applicant Info</legend>

            <div class="tab-buttons">
                <button type="button" class="active" onclick="showApplicant(1,event)">Applicant 1</button>
                <button type="button" onclick="showApplicant(2,event)">Applicant 2</button>
                <button type="button" onclick="showApplicant(3,event)">Applicant 3</button>
            </div>

            <!-- Applicant 1 -->
            <div id="applicant1" class="applicant-tab active">
                <div class="form-grid-4">
                    <div class="form-group">
                        <label>Salutation</label>
                        <select><option>Mr.</option><option>Mrs.</option><option>Ms.</option></select>
                    </div>
                    <div class="form-group">
                        <label>First Name</label>
                        <input type="text" required>
                    </div>
                    <div class="form-group">
                        <label>Middle Name</label>
                        <input type="text">
                    </div>
                    <div class="form-group">
                        <label>Last Name</label>
                        <input type="text" required>
                    </div>
                </div>

                <div class="form-row">
                    <label>Mobile</label>
                    <input type="text">
                    <label>Email</label>
                    <input type="email">
                </div>
            </div>

            <!-- Applicant 2 -->
            <div id="applicant2" class="applicant-tab">
                <div class="form-grid-4">
                    <div class="form-group">
                        <label>Salutation</label>
                        <select><option>Mr.</option><option>Mrs.</option><option>Ms.</option></select>
                    </div>
                    <div class="form-group"><label>First Name</label><input type="text"></div>
                    <div class="form-group"><label>Middle Name</label><input type="text"></div>
                    <div class="form-group"><label>Last Name</label><input type="text"></div>
                </div>
            </div>

            <!-- Applicant 3 -->
            <div id="applicant3" class="applicant-tab">
                <div class="form-grid-4">
                    <div class="form-group">
                        <label>Salutation</label>
                        <select><option>Mr.</option><option>Mrs.</option><option>Ms.</option></select>
                    </div>
                    <div class="form-group"><label>First Name</label><input type="text"></div>
                    <div class="form-group"><label>Middle Name</label><input type="text"></div>
                    <div class="form-group"><label>Last Name</label><input type="text"></div>
                </div>
            </div>
        </fieldset>

        <!-- Unit & Cost -->
        <fieldset>
            <legend>Unit & Cost Details</legend>

            <div class="form-row">
                <label>Wing</label>
                <select id="wing" required></select>

                <label>Floor</label>
                <select id="floor" required></select>

                <label>Unit No</label>
                <select id="unitNumber" required></select>

                <label>Carpet</label>
                <input type="number" id="carpet" readonly>
            </div>

            <div class="form-row">
                <label>Agreement Cost</label>
                <input type="number" id="agreementCost" required>

                <label>GST</label>
                <input type="number" id="gst" readonly>

                <label>Stamp Duty</label>
                <input type="number" id="stampDuty" readonly>

                <label>Registration</label>
                <input type="number" id="registration" readonly>
            </div>

            <div class="form-row">
                <label>Furniture Charges</label>
                <input type="number" id="furnitureCharges" value="0">

                <label>Actual Package</label>
                <input type="number" id="actualPackage" readonly>

                <label>Package Total</label>
                <input type="number" id="packageTotal" readonly>

                <label>Parking</label>
                <select>
                    <option>Open</option>
                    <option>Covered</option>
                </select>
            </div>
        </fieldset>

        <!-- Buttons -->
        <div class="button-row">
            <button type="submit" class="save-btn">Save</button>
            <button type="button" class="close-btn">Close</button>
        </div>

    </form>
</div>

<script>
/* Applicant Tabs */
function showApplicant(num, event) {
    event.preventDefault();
    document.querySelectorAll(".applicant-tab").forEach(t => t.classList.remove("active"));
    document.querySelectorAll(".tab-buttons button").forEach(b => b.classList.remove("active"));
    document.getElementById("applicant" + num).classList.add("active");
    event.target.classList.add("active");
}

/* Wing Floor Unit */
const wing = document.getElementById("wing");
const floor = document.getElementById("floor");
const unit = document.getElementById("unitNumber");
const carpet = document.getElementById("carpet");

["A","B","C","D","E","F"].forEach(w => wing.add(new Option(w,w)));
[1,2,3,4,5,6,7].forEach(f => floor.add(new Option(f,f)));

floor.addEventListener("change", () => {
    unit.innerHTML = '<option value="">Select</option>';
    for(let i=1;i<=7;i++){
        unit.add(new Option(floor.value + "0" + i, floor.value + "0" + i));
    }
});

const carpetMap = { "101":650,"102":680,"103":720,"104":750,"105":800,"106":820,"107":850 };

unit.addEventListener("change", ()=>{
    carpet.value = carpetMap["10"+unit.value.slice(-1)] || "";
});

/* Cost Calculation */
const agreement = document.getElementById("agreementCost");
const gst = document.getElementById("gst");
const stamp = document.getElementById("stampDuty");
const reg = document.getElementById("registration");
const furn = document.getElementById("furnitureCharges");
const actual = document.getElementById("actualPackage");
const total = document.getElementById("packageTotal");

function calc(){
    const c = Number(agreement.value)||0;
    const f = Number(furn.value)||0;
    gst.value = (c*0.05).toFixed(0);
    stamp.value = (c*0.06).toFixed(0);
    reg.value = 30000;
    actual.value = c+f;
    total.value = c + f + Number(gst.value) + Number(stamp.value) + 30000;
}

agreement.addEventListener("input", calc);
furn.addEventListener("input", calc);

/* Save (Frontend Test) */
document.getElementById("bookingForm").addEventListener("submit", e=>{
    e.preventDefault();
    alert("Form validated successfully!");
});
</script>

</body>
</html>
